import pygame
import sys
import random
import math

# Initialize pygame
pygame.init()

# Screen dimensions
WIDTH, HEIGHT = 800, 600
screen = pygame.display.set_mode((WIDTH, HEIGHT))
pygame.display.set_caption("Biology Love Meter")

# Colors
WHITE = (255, 255, 255)
BLACK = (0, 0, 0)
GREEN = (0, 200, 0)
RED = (200, 0, 0)
BLUE = (0, 120, 255)
LIGHT_BLUE = (173, 216, 230)
GRAY = (200, 200, 200)
DARK_GREEN = (0, 150, 0)
LIGHT_RED = (255, 150, 150)

# Fonts
title_font = pygame.font.SysFont("Arial", 48, bold=True)
button_font = pygame.font.SysFont("Arial", 28)
message_font = pygame.font.SysFont("Arial", 36, bold=True)

# Button class
class Button:
    def __init__(self, x, y, width, height, text, color, hover_color):
        self.rect = pygame.Rect(x, y, width, height)
        self.text = text
        self.color = color
        self.hover_color = hover_color
        self.original_color = color
        self.is_hovered = False
        
    def draw(self, surface):
        color = self.hover_color if self.is_hovered else self.color
        pygame.draw.rect(surface, color, self.rect, border_radius=12)
        pygame.draw.rect(surface, BLACK, self.rect, 3, border_radius=12)
        
        text_surface = button_font.render(self.text, True, BLACK)
        text_rect = text_surface.get_rect(center=self.rect.center)
        surface.blit(text_surface, text_rect)
        
    def check_hover(self, pos):
        self.is_hovered = self.rect.collidepoint(pos)
        return self.is_hovered
        
    def check_click(self, pos, event):
        if event.type == pygame.MOUSEBUTTONDOWN and event.button == 1:
            return self.rect.collidepoint(pos)
        return False

# Runaway button class
class RunawayButton(Button):
    def __init__(self, x, y, width, height, text, color, hover_color):
        super().__init__(x, y, width, height, text, color, hover_color)
        self.speed = 5
        self.direction = [0, 0]
        self.set_random_direction()
        
    def set_random_direction(self):
        angle = random.uniform(0, 2 * math.pi)
        self.direction = [math.cos(angle), math.sin(angle)]
        
    def update(self, mouse_pos):
        # Check if mouse is near the button
        dx = mouse_pos[0] - self.rect.centerx
        dy = mouse_pos[1] - self.rect.centery
        distance = math.sqrt(dx*dx + dy*dy)
        
        if distance < 200:  # If mouse is close, run away
            # Move in the current direction
            self.rect.x += self.direction[0] * self.speed
            self.rect.y += self.direction[1] * self.speed
            
            # Bounce off walls
            if self.rect.left < 0 or self.rect.right > WIDTH:
                self.direction[0] *= -1
                self.rect.x += self.direction[0] * self.speed
                
            if self.rect.top < 0 or self.rect.bottom > HEIGHT:
                self.direction[1] *= -1
                self.rect.y += self.direction[1] * self.speed
                
            # Occasionally change direction
            if random.random() < 0.02:
                self.set_random_direction()

# Create buttons
button_width, button_height = 200, 60
button_y = 350
button_spacing = 30

button1 = Button(WIDTH//2 - button_width - button_spacing, button_y, 
                button_width, button_height, "1%", GREEN, DARK_GREEN)

button2 = Button(WIDTH//2 + button_spacing, button_y, 
                button_width, button_height, "100%", BLUE, LIGHT_BLUE)

button3 = RunawayButton(WIDTH//2 - button_width//2, button_y + button_height + button_spacing, 
                       button_width, button_height, "I fucking don't", RED, LIGHT_RED)

# Game state
message = ""
message_timer = 0

# Main game loop
clock = pygame.time.Clock()
running = True

while running:
    mouse_pos = pygame.mouse.get_pos()
    
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            running = False
            
        # Check button clicks
        if button1.check_click(mouse_pos, event):
            button1.text = "100005"
            message = "Wow! That's specific!"
            message_timer = 120  # Show message for 2 seconds
            
        if button2.check_click(mouse_pos, event):
            message = "Biology loves you too!"
            message_timer = 120
            
        if button3.check_click(mouse_pos, event):
            message = "Hey! Stop running away!"
            message_timer = 120
    
    # Update runaway button
    button3.update(mouse_pos)
    
    # Check hovers
    button1.check_hover(mouse_pos)
    button2.check_hover(mouse_pos)
    button3.check_hover(mouse_pos)
    
    # Decrease message timer
    if message_timer > 0:
        message_timer -= 1
    
    # Draw everything
    screen.fill(WHITE)
    
    # Draw title
    title_text = title_font.render("How much do you love biology?", True, BLACK)
    title_rect = title_text.get_rect(center=(WIDTH//2, 150))
    screen.blit(title_text, title_rect)
    
    # Draw buttons
    button1.draw(screen)
    button2.draw(screen)
    button3.draw(screen)
    
    # Draw message if any
    if message_timer > 0:
        message_text = message_font.render(message, True, BLACK)
        message_rect = message_text.get_rect(center=(WIDTH//2, 250))
        screen.blit(message_text, message_rect)
    
    # Draw biology-themed background elements
    pygame.draw.ellipse(screen, GREEN, (100, 80, 60, 100))  # Leaf
    pygame.draw.ellipse(screen, GREEN, (640, 80, 60, 100))  # Leaf
    
    # Draw DNA strand
    for i in range(10):
        y_pos = 500 + i * 15
        pygame.draw.line(screen, BLUE, (WIDTH//2 - 30, y_pos), (WIDTH//2 + 30, y_pos + 10), 2)
        pygame.draw.circle(screen, GREEN, (WIDTH//2 - 30, y_pos), 5)
        pygame.draw.circle(screen, RED, (WIDTH//2 + 30, y_pos + 10), 5)
    
    pygame.display.flip()
    clock.tick(60)

pygame.quit()
sys.exit()
